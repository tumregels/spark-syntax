
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Section 2.11  - Unionizing Multiple Dataframes Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Section 2.12 - Performing Joins <clean one>.html" />
    
    
    <link rel="prev" href="Section 2.10 - Spark Functions aren't Enough, I Need my Own!.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    README
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Chapter 1 - Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Chapter 1 - Basics/Section 1 - Useful Material.html">
            
                <a href="../Chapter 1 - Basics/Section 1 - Useful Material.html">
            
                    
                    Section 1 - Useful Material
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Chapter 1 - Basics/Section 2 - Creating your First Data Object.html">
            
                <a href="../Chapter 1 - Basics/Section 2 - Creating your First Data Object.html">
            
                    
                    Section 2 - Creating your First Data Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Chapter 1 - Basics/Section 3 - Reading your First Dataset.html">
            
                <a href="../Chapter 1 - Basics/Section 3 - Reading your First Dataset.html">
            
                    
                    Section 3 - Reading your First Dataset
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Chapter 1 - Basics/Section 4 - More Comfortable with SQL.html">
            
                <a href="../Chapter 1 - Basics/Section 4 - More Comfortable with SQL.html">
            
                    
                    Section 4 - More Comfortable with SQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Chapter 2 - Exploring the Spark APIs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Section 1.1 - Struct Types.html">
            
                <a href="Section 1.1 - Struct Types.html">
            
                    
                    Section 1.1 - Struct Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="Section 1.2 - Arrays and Lists.html">
            
                <a href="Section 1.2 - Arrays and Lists.html">
            
                    
                    Section 1.2 - Arrays and Lists
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="Section 1.3 - Maps and Dictionaries.html">
            
                <a href="Section 1.3 - Maps and Dictionaries.html">
            
                    
                    Section 1.3 - Maps and Dictionaries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="Section 1.4 - Decimals and Why did my Decimals Overflow.html">
            
                <a href="Section 1.4 - Decimals and Why did my Decimals Overflow.html">
            
                    
                    Section 1.4 - Decimals and Why did my Decimals Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="Section 2 - Performing your First Transformations.html">
            
                <a href="Section 2 - Performing your First Transformations.html">
            
                    
                    Section 2 - Performing your First Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="Section 2.1 - Looking at Your Data.html">
            
                <a href="Section 2.1 - Looking at Your Data.html">
            
                    
                    Section 2.1 - Looking at Your Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="Section 2.2 - Selecting a Subset of Columns.html">
            
                <a href="Section 2.2 - Selecting a Subset of Columns.html">
            
                    
                    Section 2.2 - Selecting a Subset of Columns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="Section 2.3 - Creating New Columns and Transforming Data.html">
            
                <a href="Section 2.3 - Creating New Columns and Transforming Data.html">
            
                    
                    Section 2.3 - Creating New Columns and Transforming Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="Section 2.4 - Constant Values and Column Expressions.html">
            
                <a href="Section 2.4 - Constant Values and Column Expressions.html">
            
                    
                    Section 2.4 - Constant Values and Column Expressions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="Section 2.5 - Casting Columns to Different Type.html">
            
                <a href="Section 2.5 - Casting Columns to Different Type.html">
            
                    
                    Section 2.5 - Casting Columns to Different Type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="Section 2.6 - Filtering Data.html">
            
                <a href="Section 2.6 - Filtering Data.html">
            
                    
                    Section 2.6 - Filtering Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="Section 2.7 - Equality Statements in Spark and Comparison with Nulls.html">
            
                <a href="Section 2.7 - Equality Statements in Spark and Comparison with Nulls.html">
            
                    
                    Section 2.7 - Equality Statements in Spark and Comparison with Nulls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="Section 2.8 - Case Statements.html">
            
                <a href="Section 2.8 - Case Statements.html">
            
                    
                    Section 2.8 - Case Statements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.14" data-path="Section 2.9 - Filling in Null Values.html">
            
                <a href="Section 2.9 - Filling in Null Values.html">
            
                    
                    Section 2.9 - Filling in Null Values
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.15" data-path="Section 2.10 - Spark Functions aren't Enough, I Need my Own!.html">
            
                <a href="Section 2.10 - Spark Functions aren't Enough, I Need my Own!.html">
            
                    
                    Section 2.10 - Spark Functions aren't Enough, I Need my Own!
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.16" data-path="Section 2.11  - Unionizing Multiple Dataframes.html">
            
                <a href="Section 2.11  - Unionizing Multiple Dataframes.html">
            
                    
                    Section 2.11  - Unionizing Multiple Dataframes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.17" data-path="Section 2.12 - Performing Joins <clean one>.html">
            
                <a href="Section 2.12 - Performing Joins <clean one>.html">
            
                    
                    Section 2.12 - Performing Joins 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.18" data-path="Section 3.1 - One to Many Rows.html">
            
                <a href="Section 3.1 - One to Many Rows.html">
            
                    
                    Section 3.1 - One to Many Rows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.19" data-path="Section 3.2 - Range Join Conditions <WIP>.html">
            
                <a href="Section 3.2 - Range Join Conditions <WIP>.html">
            
                    
                    Section 3.2 - Range Join Conditions 
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Chapter 3 - Aggregates
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../Chapter 3 - Aggregates/Section 1 - Clean Aggregations.html">
            
                <a href="../Chapter 3 - Aggregates/Section 1 - Clean Aggregations.html">
            
                    
                    Section 1 - Clean Aggregations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../Chapter 3 - Aggregates/Section 2 - Non Deterministic Ordering for GroupBys.html">
            
                <a href="../Chapter 3 - Aggregates/Section 2 - Non Deterministic Ordering for GroupBys.html">
            
                    
                    Section 2 - Non Deterministic Ordering for GroupBys
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Chapter 4 - Window Objects
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Chapter 4 - Window Objects/Section 1 - Default Behaviour of a Window Object.html">
            
                <a href="../Chapter 4 - Window Objects/Section 1 - Default Behaviour of a Window Object.html">
            
                    
                    Section 1 - Default Behaviour of a Window Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Chapter 4 - Window Objects/Section 2 - Ordering High Frequency Data with a Window Object.html">
            
                <a href="../Chapter 4 - Window Objects/Section 2 - Ordering High Frequency Data with a Window Object.html">
            
                    
                    Section 2 - Ordering High Frequency Data with a Window Object
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Chapter 6 - Tuning & Spark Parameters
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../Chapter 6 - Tuning & Spark Parameters/Section 1.1 - Understanding how Spark Works.html">
            
                <a href="../Chapter 6 - Tuning & Spark Parameters/Section 1.1 - Understanding how Spark Works.html">
            
                    
                    Section 1.1 - Understanding how Spark Works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Chapter 7 - High Performance Code
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../Chapter 7 - High Performance Code/Section 1.1 - Filter Pushdown.html">
            
                <a href="../Chapter 7 - High Performance Code/Section 1.1 - Filter Pushdown.html">
            
                    
                    Section 1.1 - Filter Pushdown
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../Chapter 7 - High Performance Code/Section 1.2 - Joins on Skewed Data <Null Keys>.html">
            
                <a href="../Chapter 7 - High Performance Code/Section 1.2 - Joins on Skewed Data <Null Keys>.html">
            
                    
                    Section 1.2 - Joins on Skewed Data 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../Chapter 7 - High Performance Code/Section 1.3 - Joins on Skewed Data <High Frequency Keys I>.html">
            
                <a href="../Chapter 7 - High Performance Code/Section 1.3 - Joins on Skewed Data <High Frequency Keys I>.html">
            
                    
                    Section 1.3 - Joins on Skewed Data 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../Chapter 7 - High Performance Code/Section 1.4 - Joins on Skewed Data <High Frequency Keys II> <WIP>.html">
            
                <a href="../Chapter 7 - High Performance Code/Section 1.4 - Joins on Skewed Data <High Frequency Keys II> <WIP>.html">
            
                    
                    Section 1.4 - Joins on Skewed Data  
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Section 2.11  - Unionizing Multiple Dataframes</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="library-imports">Library Imports</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession
<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> types <span class="hljs-keyword">as</span> T

<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> functions <span class="hljs-keyword">as</span> F

<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> decimal <span class="hljs-keyword">import</span> Decimal
</code></pre>
<h3 id="template">Template</h3>
<pre><code class="lang-python">spark = (
    SparkSession.builder
    .master(<span class="hljs-string">&quot;local&quot;</span>)
    .appName(<span class="hljs-string">&quot;Section 2.11  - Unionizing Multiple Dataframes&quot;</span>)
    .config(<span class="hljs-string">&quot;spark.some.config.option&quot;</span>, <span class="hljs-string">&quot;some-value&quot;</span>)
    .getOrCreate()
)

sc = spark.sparkContext

<span class="hljs-keyword">import</span> os

data_path = <span class="hljs-string">&quot;/data/pets.csv&quot;</span>
base_path = os.path.dirname(os.getcwd())
path = base_path + data_path
</code></pre>
<pre><code class="lang-python">pets = spark.read.csv(path, header=<span class="hljs-keyword">True</span>)
pets.toPandas()
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>breed_id</th>
      <th>nickname</th>
      <th>birthday</th>
      <th>age</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>King</td>
      <td>2014-11-22 12:30:31</td>
      <td>5</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>Argus</td>
      <td>2016-11-22 10:05:10</td>
      <td>10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Chewie</td>
      <td>2016-11-22 10:05:10</td>
      <td>15</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2</td>
      <td>Maple</td>
      <td>2018-11-22 10:05:10</td>
      <td>17</td>
      <td>white</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="unionizing-multiple-dataframes">Unionizing Multiple Dataframes</h3>
<p>There are a couple of situations where you would want to perform an union transformation.</p>
<p><strong>Case 1: Collecting Data from Various Sources</strong></p>
<p>When you&apos;re collecting data from multiple sources, some point in your spark application you will need to reconcile all the different sources into the same format and work with a single source of truth. This will require you to <code>union</code> the different datasets together.</p>
<p><strong>Case 2: Perfoming Different Transformations on your Dataset</strong></p>
<p>Sometimes you would like to perform seperate transformations on different parts of your data based on your task. This would involve breaking up your dataset into different parts and working on them individually. Then at some point you might want to stitch they back together, this would again be a <code>union</code> operation.</p>
<h3 id="case-1---union-the-wrong-way">Case 1 - <code>union()</code> (the Wrong Way)</h3>
<pre><code class="lang-python">pets_2 = pets.select(
    <span class="hljs-string">&apos;breed_id&apos;</span>,
    <span class="hljs-string">&apos;id&apos;</span>,
    <span class="hljs-string">&apos;age&apos;</span>,
    <span class="hljs-string">&apos;color&apos;</span>,
    <span class="hljs-string">&apos;birthday&apos;</span>,
    <span class="hljs-string">&apos;nickname&apos;</span>
)

(
    pets
    .union(pets_2)
    .where(F.col(<span class="hljs-string">&apos;id&apos;</span>).isin(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))
    .toPandas()
)
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>breed_id</th>
      <th>nickname</th>
      <th>birthday</th>
      <th>age</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>King</td>
      <td>2014-11-22 12:30:31</td>
      <td>5</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>Argus</td>
      <td>2016-11-22 10:05:10</td>
      <td>10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>brown</td>
      <td>2014-11-22 12:30:31</td>
      <td>King</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>15</td>
      <td>None</td>
      <td>2016-11-22 10:05:10</td>
      <td>Chewie</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>3</td>
      <td>17</td>
      <td>white</td>
      <td>2018-11-22 10:05:10</td>
      <td>Maple</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="case-1---another-wrong-way">Case 1 - Another Wrong Way</h3>
<pre><code class="lang-python">pets_3 = pets.select(
    <span class="hljs-string">&apos;*&apos;</span>,
    <span class="hljs-string">&apos;*&apos;</span>
)

pets_3.show()

(
    pets
    .union(pets_3)
    .where(F.col(<span class="hljs-string">&apos;id&apos;</span>).isin(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))
    .toPandas()
)
</code></pre>
<pre><code>+---+--------+--------+-------------------+---+-----+---+--------+--------+-------------------+---+-----+
| id|breed_id|nickname|           birthday|age|color| id|breed_id|nickname|           birthday|age|color|
+---+--------+--------+-------------------+---+-----+---+--------+--------+-------------------+---+-----+
|  1|       1|    King|2014-11-22 12:30:31|  5|brown|  1|       1|    King|2014-11-22 12:30:31|  5|brown|
|  2|       3|   Argus|2016-11-22 10:05:10| 10| null|  2|       3|   Argus|2016-11-22 10:05:10| 10| null|
|  3|       1|  Chewie|2016-11-22 10:05:10| 15| null|  3|       1|  Chewie|2016-11-22 10:05:10| 15| null|
|  3|       2|   Maple|2018-11-22 10:05:10| 17|white|  3|       2|   Maple|2018-11-22 10:05:10| 17|white|
+---+--------+--------+-------------------+---+-----+---+--------+--------+-------------------+---+-----+




---------------------------------------------------------------------------

AnalysisException                         Traceback (most recent call last)

&lt;ipython-input-5-c8157f574918&gt; in &lt;module&gt;()
      8 (
      9     pets
---&gt; 10     .union(pets_3)
     11     .where(F.col(&apos;id&apos;).isin(1,2))
     12     .toPandas()


/usr/local/lib/python2.7/site-packages/pyspark/sql/dataframe.pyc in union(self, other)
   1336         Also as standard in SQL, this function resolves columns by position (not by name).
   1337         &quot;&quot;&quot;
-&gt; 1338         return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
   1339 
   1340     @since(1.3)


/usr/local/lib/python2.7/site-packages/py4j/java_gateway.pyc in __call__(self, *args)
   1255         answer = self.gateway_client.send_command(command)
   1256         return_value = get_return_value(
-&gt; 1257             answer, self.gateway_client, self.target_id, self.name)
   1258 
   1259         for temp_arg in temp_args:


/usr/local/lib/python2.7/site-packages/pyspark/sql/utils.pyc in deco(*a, **kw)
     67                                              e.java_exception.getStackTrace()))
     68             if s.startswith(&apos;org.apache.spark.sql.AnalysisException: &apos;):
---&gt; 69                 raise AnalysisException(s.split(&apos;: &apos;, 1)[1], stackTrace)
     70             if s.startswith(&apos;org.apache.spark.sql.catalyst.analysis&apos;):
     71                 raise AnalysisException(s.split(&apos;: &apos;, 1)[1], stackTrace)


AnalysisException: u&quot;Union can only be performed on tables with the same number of columns, but the first table has 6 columns and the second table has 12 columns;;\n&apos;Union\n:- Relation[id#10,breed_id#11,nickname#12,birthday#13,age#14,color#15] csv\n+- Project [id#10, breed_id#11, nickname#12, birthday#13, age#14, color#15, id#10, breed_id#11, nickname#12, birthday#13, age#14, color#15]\n   +- Relation[id#10,breed_id#11,nickname#12,birthday#13,age#14,color#15] csv\n&quot;
</code></pre><p><strong>What Happened?</strong></p>
<p>This actually worked out quite nicely, I forgot this was the case actually. <strong>Spark will only allow you to union <code>df</code> that have the exact number of columns and where the column datatypes are exactly the same.</strong></p>
<p><strong>Case 1</strong></p>
<p>Because we infered the schema and datatypes from the csv file it was able to union the 2 dataframes, but the results doesn&apos;t make sense at all; The columns don&apos;t match up.</p>
<p><strong>Case 2</strong></p>
<p>We created a new dataframe with twice the numnber of columns and tried to union it with the original <code>df</code>, spark threw an error as it doesn&apos;t know what to do when the number of columns don&apos;t match up.</p>
<h3 id="case-2---union-the-right-way">Case 2 - <code>union()</code> (the Right Way)</h3>
<pre><code class="lang-python">(
    pets
    .union(pets_2.select(pets.columns))
    .union(pets_3.select(pets.columns))
    .toPandas()
)
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>breed_id</th>
      <th>nickname</th>
      <th>birthday</th>
      <th>age</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>King</td>
      <td>2014-11-22 12:30:31</td>
      <td>5</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>Argus</td>
      <td>2016-11-22 10:05:10</td>
      <td>10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Chewie</td>
      <td>2016-11-22 10:05:10</td>
      <td>15</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2</td>
      <td>Maple</td>
      <td>2018-11-22 10:05:10</td>
      <td>17</td>
      <td>white</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>King</td>
      <td>2014-11-22 12:30:31</td>
      <td>5</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>3</td>
      <td>Argus</td>
      <td>2016-11-22 10:05:10</td>
      <td>10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>1</td>
      <td>Chewie</td>
      <td>2016-11-22 10:05:10</td>
      <td>15</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>2</td>
      <td>Maple</td>
      <td>2018-11-22 10:05:10</td>
      <td>17</td>
      <td>white</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>1</td>
      <td>King</td>
      <td>2014-11-22 12:30:31</td>
      <td>5</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>3</td>
      <td>Argus</td>
      <td>2016-11-22 10:05:10</td>
      <td>10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>1</td>
      <td>Chewie</td>
      <td>2016-11-22 10:05:10</td>
      <td>15</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3</td>
      <td>2</td>
      <td>Maple</td>
      <td>2018-11-22 10:05:10</td>
      <td>17</td>
      <td>white</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>What Happened?</strong></p>
<p>The columns match perfectly! How? <strong>For each of the new <code>df</code> that you would like to union with the original <code>df</code> you will <code>select</code> the column from the original <code>df</code> during the union.</strong> This will:</p>
<ol>
<li>Guarantees the ordering of the columns, as a <code>select</code> will select the columns in order of which they are listed in.</li>
<li>Guarantees that only the columns of the original <code>df</code> is selected, from the previous sections, we know that <code>select</code> will only the specified columns.</li>
</ol>
<h3 id="summary">Summary</h3>
<ul>
<li>Always always be careful when you are <code>union</code>ing <code>df</code> together.</li>
<li>When you <code>union</code> <code>df</code>s together you should ensure:<ol>
<li>The number of columns are the same.</li>
<li>The columns are the exact same.</li>
<li>The columns are in the same order.</li>
</ol>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Section 2.10 - Spark Functions aren't Enough, I Need my Own!.html" class="navigation navigation-prev " aria-label="Previous page: Section 2.10 - Spark Functions aren't Enough, I Need my Own!">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Section 2.12 - Performing Joins <clean one>.html" class="navigation navigation-next " aria-label="Next page: Section 2.12 - Performing Joins ">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Section 2.11  - Unionizing Multiple Dataframes","level":"1.3.16","depth":2,"next":{"title":"Section 2.12 - Performing Joins ","level":"1.3.17","depth":2,"path":"Chapter 2 - Exploring the Spark APIs/Section 2.12 - Performing Joins <clean one>.md","ref":"Chapter 2 - Exploring the Spark APIs/Section 2.12 - Performing Joins <clean one>.md","articles":[]},"previous":{"title":"Section 2.10 - Spark Functions aren't Enough, I Need my Own!","level":"1.3.15","depth":2,"path":"Chapter 2 - Exploring the Spark APIs/Section 2.10 - Spark Functions aren't Enough, I Need my Own!.md","ref":"Chapter 2 - Exploring the Spark APIs/Section 2.10 - Spark Functions aren't Enough, I Need my Own!.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","katex@1.1.3","edit-link@2.0.x","github@2.0.x"],"root":"./src","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"edit-link":{"label":"Edit","base":"https://github.com/ericxiao251/spark-syntax/edit/master"},"github":{"url":"https://github.com/ericxiao251/spark-syntax"},"katex":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":14,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"toc":true},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"3.2.x"},"file":{"path":"Chapter 2 - Exploring the Spark APIs/Section 2.11  - Unionizing Multiple Dataframes.md","mtime":"2019-03-21T01:55:34.979Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-21T01:55:40.233Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

